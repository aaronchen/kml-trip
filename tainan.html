<!DOCTYPE html>
<html lang="en">
  <head>
    <title>台南一日遊</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <!-- Latest Google Maps JS API with callback -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCt6MJCC4v14LEdhjDFwseIjDJGt45MUfI&callback=initMap&libraries=places" async defer></script>

    <style>
      .nav-pills { margin: 20px 0; }
      .nav-pills > li > a { padding: 5px 10px; }
      .btn { margin: 5px 0; }
      .logo-label { font-size: 12px; font-weight: bold; padding: 2px 0; width: 88px; min-width: 88px; text-align: center; color: #fff; background-color: #333; border-radius: 3px; display: inline-block; }
      .form-label { font-size: 14px; font-weight: bold; padding: 10px 0 0 15px; }
      .glyphicon-map-marker { color: #333; }
      .glyphicon-arrow-right { color: #999; }
      a:link, a:visited, a:visited:hover, a:hover, a:active { text-decoration: none; }
      #map { width: 100%; height: 300px; }
      @media screen and (max-width: 576px) {
        .form-label { font-size: 12px; font-weight: bold; padding: 8px 0 0 15px; }
        .form-control { margin-left: 10px; width: 95%; }
      }
    </style>
  </head>

  <body>
    <div class="container my-4">
      <h4>
        <a href="https://www.google.com/maps/d/viewer?mid=1FmlAtBSVCKGcKnzRjE4NLhsIb0bTntBX&hl=en&usp=sharing" target="_blank">台南一日遊</a>
      </h4>

      <ul class="nav nav-pills nav-fill mb-3 gap-2" id="groupTabs" role="tablist">
        
        <li class="nav-item">
          <a class="nav-link active" href="#" data-group="0">
            台南
          </a>
        </li>
  
      </ul>

      <form>
        <div class="row mb-3 align-items-center">
          <label class="col-sm-1 col-form-label" for="from">From:</label>
          <div class="col-sm-11">
            <select id="from" class="form-select">
              
              <option value="" data-color="#d3a">Current Location</option>

              <option value='22.9246481,120.2856715'
                      data-group='0'
                      data-color='9C27B0'
                      data-placeid='ChIJpR6pAaZzbjQR58nDfF1UPgI'>
                台南高鐵站
              </option>
    
              <option value='22.9904503,120.2043085'
                      data-group='0'
                      data-color='01579B'
                      data-placeid='ChIJFbzVrGJ2bjQRkZC9jslaIgs'>
                台南孔子廟
              </option>
    
              <option value='22.9900166,120.2050025'
                      data-group='0'
                      data-color='01579B'
                      data-placeid='ChIJAQAAAGV2bjQRXjep1tdZrDU'>
                莿桐花巷
              </option>
    
              <option value='22.989008,120.204296'
                      data-group='0'
                      data-color='01579B'
                      data-placeid='ChIJj_BdaH12bjQRiNiIE0EkXdg'>
                台南愛國婦人館
              </option>
    
              <option value='22.997478,120.2025433'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJbYl7d2F2bjQRnFdvyMBuZfI'>
                赤崁樓

              </option>
    
              <option value='22.9976606,120.1990641'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJCzZbxWZ2bjQR6CUWOMHz1hI'>
                金得春捲
              </option>
    
              <option value='22.9975976,120.1990892'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJezCwC8p3bjQRDdtipPr_yZQ'>
                富盛號碗粿
              </option>
    
              <option value='22.9976615,120.1989729'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJwcrlsWZ2bjQRuSR57DvjKOE'>
                阿松割包
              </option>
    
              <option value='22.9976555,120.1988449'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJAWGE7WR2bjQRpv7SQ5FqUDg'>
                一品味碗粿魚羮
              </option>
    
              <option value='22.9974748,120.1989853'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJGS-dzWR2bjQR1OBnRJzR6Mo'>
                石精臼蚵仔煎
              </option>
    
              <option value='22.9971844,120.198772'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJ2UjvqGZ2bjQRRMnl0SQ7b8c'>
                修安扁擔豆花
              </option>
    
              <option value='22.9975171,120.1964949'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJqctagGZ2bjQRGlAjSFrC5hE'>
                神農街
              </option>
    
              <option value='22.9977415,120.1959892'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJP3T7eGZ2bjQR2BO9rFUrYEY'>
                室町丼作食事
              </option>
    
              <option value='23.0015093,120.1606244'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJZ-TjeHN2bjQR8a3Jat0VHps'>
                安平古堡
              </option>
    
              <option value='23.0032433,120.1595373'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJlynOByF3bjQR_IzNSlgH-Ss'>
                安平樹屋
              </option>
    
              <option value='23.0025611,120.1563263'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJR0ctuxp2bjQRcIg1Va6v9Bc'>
                夕遊-出張所 Salt Museum
              </option>
    
              <option value='22.9993471,120.1637129'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJN7_msxx2bjQR7X5mK626e_k'>
                安平林牛肉湯
              </option>
    
              <option value='22.999908,120.1533844'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJC_GkyqjYbTQR8AlhjOqU_0w'>
                同記安平豆花
              </option>
    
              <option value='23.0028424,120.1619124'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJYyQ9TRx2bjQRkRAQqhCqZuY'>
                同記安平豆花安平2店
              </option>
    
              <option value='22.9345608,120.2260268'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJq6qqqnp0bjQRpvTHZeYTjKg'>
                奇美博物館
              </option>
    
              <option value='22.9912681,120.2102287'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJz46k3Ih2bjQRprxeq94z3Ec'>
                私之家壽司刺身
              </option>
    
              <option value='22.9888063,120.2152539'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJi1e38o92bjQRij_uJnO2qks'>
                毛丼
              </option>
    
              <option value='22.9875573,120.2309086'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJp_0fAb12bjQRe69DOW_DB6c'>
                鮨次郎壽司專賣
              </option>
    
            </select>
          </div>
        </div>

        <div class="row mb-3 align-items-center">
          <label class="col-sm-1 col-form-label" for="to">To:</label>
          <div class="col-sm-11">
            <select id="to" class="form-select">
              
              <option value="" data-color="#d3a">Current Location</option>

              <option value='22.9246481,120.2856715'
                      data-group='0'
                      data-color='9C27B0'
                      data-placeid='ChIJpR6pAaZzbjQR58nDfF1UPgI'>
                台南高鐵站
              </option>
    
              <option value='22.9904503,120.2043085'
                      data-group='0'
                      data-color='01579B'
                      data-placeid='ChIJFbzVrGJ2bjQRkZC9jslaIgs'>
                台南孔子廟
              </option>
    
              <option value='22.9900166,120.2050025'
                      data-group='0'
                      data-color='01579B'
                      data-placeid='ChIJAQAAAGV2bjQRXjep1tdZrDU'>
                莿桐花巷
              </option>
    
              <option value='22.989008,120.204296'
                      data-group='0'
                      data-color='01579B'
                      data-placeid='ChIJj_BdaH12bjQRiNiIE0EkXdg'>
                台南愛國婦人館
              </option>
    
              <option value='22.997478,120.2025433'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJbYl7d2F2bjQRnFdvyMBuZfI'>
                赤崁樓

              </option>
    
              <option value='22.9976606,120.1990641'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJCzZbxWZ2bjQR6CUWOMHz1hI'>
                金得春捲
              </option>
    
              <option value='22.9975976,120.1990892'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJezCwC8p3bjQRDdtipPr_yZQ'>
                富盛號碗粿
              </option>
    
              <option value='22.9976615,120.1989729'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJwcrlsWZ2bjQRuSR57DvjKOE'>
                阿松割包
              </option>
    
              <option value='22.9976555,120.1988449'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJAWGE7WR2bjQRpv7SQ5FqUDg'>
                一品味碗粿魚羮
              </option>
    
              <option value='22.9974748,120.1989853'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJGS-dzWR2bjQR1OBnRJzR6Mo'>
                石精臼蚵仔煎
              </option>
    
              <option value='22.9971844,120.198772'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJ2UjvqGZ2bjQRRMnl0SQ7b8c'>
                修安扁擔豆花
              </option>
    
              <option value='22.9975171,120.1964949'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJqctagGZ2bjQRGlAjSFrC5hE'>
                神農街
              </option>
    
              <option value='22.9977415,120.1959892'
                      data-group='0'
                      data-color='7CB342'
                      data-placeid='ChIJP3T7eGZ2bjQR2BO9rFUrYEY'>
                室町丼作食事
              </option>
    
              <option value='23.0015093,120.1606244'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJZ-TjeHN2bjQR8a3Jat0VHps'>
                安平古堡
              </option>
    
              <option value='23.0032433,120.1595373'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJlynOByF3bjQR_IzNSlgH-Ss'>
                安平樹屋
              </option>
    
              <option value='23.0025611,120.1563263'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJR0ctuxp2bjQRcIg1Va6v9Bc'>
                夕遊-出張所 Salt Museum
              </option>
    
              <option value='22.9993471,120.1637129'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJN7_msxx2bjQR7X5mK626e_k'>
                安平林牛肉湯
              </option>
    
              <option value='22.999908,120.1533844'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJC_GkyqjYbTQR8AlhjOqU_0w'>
                同記安平豆花
              </option>
    
              <option value='23.0028424,120.1619124'
                      data-group='0'
                      data-color='FF5252'
                      data-placeid='ChIJYyQ9TRx2bjQRkRAQqhCqZuY'>
                同記安平豆花安平2店
              </option>
    
              <option value='22.9345608,120.2260268'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJq6qqqnp0bjQRpvTHZeYTjKg'>
                奇美博物館
              </option>
    
              <option value='22.9912681,120.2102287'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJz46k3Ih2bjQRprxeq94z3Ec'>
                私之家壽司刺身
              </option>
    
              <option value='22.9888063,120.2152539'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJi1e38o92bjQRij_uJnO2qks'>
                毛丼
              </option>
    
              <option value='22.9875573,120.2309086'
                      data-group='0'
                      data-color='F57C00'
                      data-placeid='ChIJp_0fAb12bjQRe69DOW_DB6c'>
                鮨次郎壽司專賣
              </option>
    
            </select>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-sm-11 offset-sm-1">
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="mode" id="mode1" value="1" checked>
              <label class="form-check-label" for="mode1">Transit</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="mode" id="mode2" value="2">
              <label class="form-check-label" for="mode2">Driving</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="mode" id="mode3" value="3">
              <label class="form-check-label" for="mode3">Walking</label>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-sm-12">
            <button class="btn btn-primary w-100" type="button" id="route">Route</button>
          </div>
        </div>
      </form>

      <div class="card mb-3">
        <div class="card-header">
          <span class="bi bi-crosshair"></span> Map Directions
        </div>
        <div class="card-body">
          <div><span class="logo-label me-2"><i class="bi bi-apple"></i> Apple</span><span id="apple">No Route Yet</span></div>
          <div><span class="logo-label me-2"><i class="bi bi-google"></i> Google</span><span id="google">No Route Yet</span></div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="bi bi-exclamation-circle"></span> Place Info
        </div>
        <div class="card-body">
          <div id="map"></div>
        </div>
      </div>
    </div>

    <script>
      var from_html = $('#from').html();
      var to_html = $('#to').html();
      var map, marker, infowindow, service;

      function initMap() {
        // Default map center
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 35.6895, lng: 139.6917}, // Tokyo
          zoom: 10
        });
        infowindow = new google.maps.InfoWindow();
        service = new google.maps.places.PlacesService(map);
      }

      function showPlaceOnMap(lat, lng, place_name, place_id) {
        if (!map) return;
        var position = {lat: Number(lat), lng: Number(lng)};
        map.setCenter(position);
        map.setZoom(19);
        if (marker) marker.setMap(null);
        marker = new google.maps.Marker({
          map: map,
          position: position
        });
        if (place_id) {
          service.getDetails({ placeId: place_id }, function (place, status) {
            if (status === google.maps.places.PlacesServiceStatus.OK) {
              google.maps.event.clearListeners(marker, 'click');
              google.maps.event.addListener(marker, 'click', function() {
                infowindow.setContent(`
                  <div>
                    <strong>${place_name}</strong><br />
                    Rating: <strong>${place.rating || 'N/A'}</strong><br />
                    <a href="${place.url}" target="_blank">View on Google Maps</a>
                  </div>
                `);
                infowindow.open(map, marker);
              });
            }
          });
        }
      }

      $('.nav-pills .nav-link').on('click', function (event) {
        event.preventDefault();
        var group = $(this).data('group');
        $(this).toggleClass('active');

        $('#from').html(from_html).change();
        $('#to').html(to_html);
        $('.nav-link:not(.active)').each(function () {
          var hide_group = $(this).data('group');
          $(`option[data-group="${hide_group}"]`).remove();
        });
      });

      $('#from, #to, [name="mode"]').on('click', function () {
        $('#apple').empty().append('No Route Yet');
        $('#google').empty().append('No Route Yet');
      });

      $('#route').on('click', function () {
        var from_value = $('#from').val();
        var from_text = $('#from option:selected').text();
        var from_color = $('#from option:selected').data('color');
        var to_value = $('#to').val();
        var to_text = $('#to option:selected').text();
        var to_color = $('#to option:selected').data('color');
        var mode = $('[name="mode"]:checked').val();
        var href_text = `
          <span class="bi bi-geo-alt-fill" style="color: #${from_color};"></span>
          <span style='color: #${from_color};'>${from_text}</span>
          &nbsp;<span class="bi bi-arrow-right"></span>&nbsp;
          <span class="bi bi-geo-alt-fill" style="color: #${to_color};"></span>
          <span style='color: #${to_color};'>${to_text}</span>
        `;

        var mode_apple = 'r';
        var mode_google = 'transit';

        if (mode == 2) { mode_apple = 'd'; mode_google = 'driving'; }
        else if (mode == 3) { mode_apple = 'w'; mode_google = 'walking'; }

        var api_apple = `http://maps.apple.com/?saddr=${from_value}&daddr=${to_value}&dirflg=${mode_apple}`;
        var api_google = `https://www.google.com/maps/dir/?api=1&origin=${from_value}&destination=${to_value}&travelmode=${mode_google}`;

        $('#apple').empty().append(`<a href="${api_apple}" target="_blank">${href_text}</a>`);
        $('#google').empty().append(`<a href="${api_google}" target="_blank">${href_text}</a>`);
      });

      $('#from').on('change', function () {
        var location = $(this).val();
        var geocode = location.split(',');
        var place_name = $(this).find('option:selected').text();
        var place_id = $(this).find('option:selected').data('placeid') || '';
        if (geocode.length == 2 && geocode[0] && geocode[1]) {
          showPlaceOnMap(geocode[0], geocode[1], place_name, place_id);
        } else {
          if (marker) marker.setMap(null);
        }
      });
    </script>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  </body>
</html>
